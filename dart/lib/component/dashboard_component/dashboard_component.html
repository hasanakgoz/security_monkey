<div style="display:flow-root;">
    <div>

    </div>
</div>


<!-- Charts Component -->
<link rel="stylesheet" href="css/vendor/leaflet-1.3.1.css"/>
<link rel="stylesheet" href="css/vendor/MarkerCluster-1.4.1.css" />
<link rel="stylesheet" href="css/vendor/MarkerCluster.Default-1.4.1.css" />
<div>
    <style type="text/css">

        .spinner {
            position: absolute;
            left: 50%;
            top: 50%;
            height: 60px;
            width: 60px;
            margin: 0px auto;
            -webkit-animation: rotation .6s infinite linear;
            -moz-animation: rotation .6s infinite linear;
            -o-animation: rotation .6s infinite linear;
            animation: rotation .6s infinite linear;
            border-left: 6px solid rgba(0, 174, 239, .15);
            border-right: 6px solid rgba(0, 174, 239, .15);
            border-bottom: 6px solid rgba(0, 174, 239, .15);
            border-top: 6px solid rgba(0, 174, 239, .8);
            border-radius: 100%;
        }

        .nodata {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 100%;
            display: flex;
            align-items: center;
            z-index: 1020; /* 1030 is the z-index for Navigation Bar*/
            /*margin: 0px auto;*/
        }

        .nodata .inner {
            width: 50%;
            height: auto;
            margin: 0 auto;
            position: relative;
        }

        @-webkit-keyframes rotation {
            from {
                -webkit-transform: rotate(0deg);
            }
            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @-moz-keyframes rotation {
            from {
                -moz-transform: rotate(0deg);
            }
            to {
                -moz-transform: rotate(359deg);
            }
        }

        @-o-keyframes rotation {
            from {
                -o-transform: rotate(0deg);
            }
            to {
                -o-transform: rotate(359deg);
            }
        }

        @keyframes rotation {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(359deg);
            }
        }


    </style>
    <div class="container-fluid">
        <!-- Accounts Filter Dropdown -->
        <div class="row">
            <div class="col-lg-12 text-right pull-right" ng-switch="isAccountSelectDisabled()">

                <select data-toggle="select" class="form-control select select-success mrs mbm"
                        id="AccountChooser" ng-model="selectedAccount"
                        ng-change="newAccountSelected()" style="display: none">
                    <option value="__all_accounts__">All Accounts</option>
                    <option ng-repeat="account in accounts" value="{{ account.name }}">{{ account.name }}</option>
                </select>

                <div class="btn-group" ng-switch-when="true">
                    <button data-toggle="dropdown" class="btn btn-info btn-sm dropdown-toggle" type="button"
                            aria-expanded="false" disabled><span class="dropdown-label">All-Time</span></button>
                    <ul role="menu" class="dropdown-menu dropdown-menu-right">
                        <li><a href="">Daily</a></li>
                        <li><a href="">Weekly</a></li>
                        <li><a href="">Monthly</a></li>
                        <li><a href="">Annually</a></li>
                        <li><a href="">All-Time</a></li>


                    </ul>
                </div>

                <div class="btn-group" ng-switch-when="false">
                    <button data-toggle="dropdown" class="btn btn-info btn-sm dropdown-toggle" type="button"
                            aria-expanded="false">
                        <span class="dropdown-label">All-Time</span></button>
                    <ul role="menu" class="dropdown-menu dropdown-menu-right">
                        <li><a href="">Daily</a></li>
                        <li><a href="">Weekly</a></li>
                        <li><a href="">Monthly</a></li>
                        <li><a href="">Annually</a></li>
                        <li><a href="">All-Time</a></li>
                    </ul>
                </div>
                <div class="btn-group" ng-switch-when="true">
                    <button data-toggle="dropdown" class="btn btn-primary btn-sm dropdown-toggle" type="button"
                            aria-expanded="false" disabled>
                        <span class="dropdown-label">Accounts
                            <i class="fa fa-spinner fa-spin" style="color:darkblue"></i>
                        </span>
                    </button>
                    <ul role="menu" class="dropdown-menu dropdown-menu-right">
                        <li ng-repeat="account in accounts">
                            <a href=""
                               ng-click="selectedAccount = account.name; newAccountSelected()">{{ account }}</a>
                        </li>
                    </ul>
                </div>
                <div class="btn-group" ng-switch-when="false">

                    <button data-toggle="dropdown" class="btn btn-primary btn-sm dropdown-toggle" type="button"
                            aria-expanded="false"><span class="dropdown-label">
                        Accounts
                    </span></button>
                    <ul role="menu" class="dropdown-menu dropdown-menu-right">
                        <li ng-repeat="account in accounts"><a href="" onclick="filterAccounts('{{ account.name }}');"
                                                               ng-click="selectedAccount = account.name; newAccountSelected()">{{ account.name }}</a>
                        </li>
                    </ul>
                </div>
            </div>

        </div>
        <!--Vulnerabilities by Severity Start-->

        <div class="row">
            <div class="col-md-12"><h4>Vulnerabilities by Severity</h4></div>
            <div class="col-md-4 text-center">
                <a data-toggle="tooltip" data-placement="bottom"
                   title="High denotes the count of items with Audit Score over 10">
                    <dl class="palette palette-alizarin">
                        <h3 class="mt-0">{{ vulnSevScores_n.high }}</h3>
                        <span>High</span>
                    </dl>
                </a>
            </div>
            <div class="col-md-4 text-center">
                <a data-toggle="tooltip" data-placement="bottom"
                   title="Medium denotes the count of items with Audit Score between 4 and 10">

                    <dl class="palette palette-carrot">
                        <h3 class="mt-0">{{ vulnSevScores_n.medium }}</h3>
                        <span>Medium</span>
                    </dl>
                </a>

            </div>

            <div class="col-md-4 text-center">
                <a data-toggle="tooltip" data-placement="bottom"
                   title="Low denotes the count of items with Audit Score below 5">
                    <dl class="palette palette-sun-flower">
                        <h3 class="mt-0">{{ vulnSevScores_n.low }}</h3>
                        <span>Low</span>
                    </dl>
                </a>
            </div>

        </div>
        <!--Vulnerabilities by Severity End-->

        <br>
        <br>
        <!--Threat Actors Start-->

        <div class="row">
            <div class="col-md-12"><h4>Threat Actors</h4></div>
            <div class="col-lg-6">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Threat Actors Location Details</h3>
                    </div>
                    <div class="panel-body">

                        <div class="wrapper" id="worldmap_wrapper">
                            <!--World Map Component-->
                            <div id="mapid" style="height: 100%;"></div>

                        </div>
                    </div>

                </div>
            </div>

            <div class="col-lg-6">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Connection Volume by Country</h3>
                    </div>
                    <div class="panel-body">
                        <div class="wrapper" id="countries_chart">
                            <!--Chart Component-->
                            <svg id="barchart" width="98%" height="98%" class="full-width"></svg>

                        </div>
                    </div>

                </div>
            </div>

            <!--Threat Actors Location Details Modal-->
            <div id="mapModal" class="modal">
                <div class="modal-dialog modal-lg">
                    <!-- Modal content -->
                    <div class="modal-content">
                        <!--<div class="modal-heading">-->
                        <!--<h4 class="left-float"></h4>-->
                        <!--<span class="close right-float" >&times;</span>-->
                        <!--</div>-->

                        <div class="modal-header">
                            <h6 class="modal-title mt-0">Threat Actors Location Details</h6>
                            <button type="button" class="close py-0" data-dismiss="modal" onClick="closeModal()"
                                    aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>

                        <div class="modal-body">
                            <div class="left-float">
                                <span><b>IP address</b></span><br>
                                <span id="ip_address"></span>
                            </div>
                            <div class="right-float">
                                <span><b>Location</b></span><br>
                                <span>City: </span><span class="field-value-class" id="city"></span><br>
                                <span>Country: </span><span class="field-value-class" id="country"></span><br>
                                <span>Lat: </span><span class="field-value-class" id="lat"></span><br>
                                <span>Lon: </span><span class="field-value-class" id="lon"></span>
                            </div>
                            <div class="clear"></div>
                            <div>
                                <span><b>Organization</b></span><br>
                                <span>Asn: </span><span class="field-value-class" id="asn"></span><br>
                                <span>Asn org: </span><span class="field-value-class" id="asn_org"></span><br>
                                <span>Isp: </span><span class="field-value-class" id="isp"></span><br>
                                <span>Org: </span><span class="field-value-class" id="org"></span>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal" onClick="closeModal()">
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--Threat Actors End-->

        <br>

        <div class="row">

            <div class="col-md-12"><h4>Vulnerabilities Identified</h4></div>
            <div class="col-lg-6">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Technologies</h3>
                    </div>
                    <div class="panel-body">
                        <div class="wrapper" id="tech_piechart_wrapper">
                            <div id="piechart" ng-click="someClick('test');">

                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-lg-6">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">Issues by Time</h3>
                    </div>
                    <div class="panel-body">
                        <div class="wrapper" id="barchart_time_wrapper">
                            <svg id="barchart_time" width="98%%" height="98%" class="full-width"></svg>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <br>
        <br>

        <!--
        <div class="row">
            <div class="col-lg-6">
                <div class="wrapper">
                    <div><h3 class="charthead">Vulnerabilities by Severity</h3></div>
                    <div class="chart-container">
                        <canvas id="severitycanvas"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="wrapper">
                    <div><h3 class="charthead">Vulnerabilities by Technology</h3></div>
                    <div class="chart-container">

                    </div>
                </div>
            </div>
        </div>
        -->

        <!--
        <div class="row">
            <div class="col-lg-6">
                <div class="wrapper">

                    <div><h3 class="charthead">Threat Actor Locations</h3></div>
                    <leaflet-map id="worldmap" min-zoom=".75" maxBounds="[[90,-180],[-90, 180]]" fit-to-markers>
                    </leaflet-map>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="wrapper">
                    <div><h3 class="charthead">Threat Actor Connection Volume by Country</h3></div>
                    <div class="chart-container">
                        <canvas id="countrycanvas"></canvas>
                    </div>
                </div>
            </div>
        </div>
        -->
        <!-- POA&M Items Component -->
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            POA&M Items for
                            {{ selectedAccount == '__all_accounts__' ? 'All Accounts' : selectedAccount}}</h3>
                    </div>
                    <div class="panel-body" ng-switch="poamItemsLoaded">
                        <div ng-switch-when="false">
                            <p>Loading . . .</p>
                        </div>
                        <table class="table table-striped" ng-switch-when="true">
                            <thead>
                            <tr>
                                <th ng-if="selectedAccount == '__all_accounts__'">Account</th>
                                <th style="min-width: 105px">POA&M ID</th>
                                <th>Control[s]</th>
                                <th>Weakness Name</th>
                                <th>Weakness Description</th>
                                <th style="min-width: 115px">Original Detection Date</th>
                                <th>Original Risk Rating</th>
                                <th>Comments</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr ng-repeat="poamItem in poamItems">
                                <td ng-if="selectedAccount == '__all_accounts__'">{{ poamItem.account }}</td>
                                <td><span class="badge badge badge-info"><a
                                        href="#/viewitem/{{ poamItem.item_id }}">{{ poamItem.poam_id }}</a></span></td>
                                <td>{{ poamItem.control }}</td>
                                <td>{{ poamItem.weakness_name }}</td>
                                <td>{{ poamItem.weakness_description }}</td>
                                <td>{{ poamItem.create_date | date:'short'}}</td>
                                <td>{{ poamItem.score }}</td>
                                <td>{{ poamItem.comments }}</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="panel-footer">
                        <div class="row">
                            <div class="col-lg-9">
                                <pagination
                                        items-per-page="ipp_as_int"
                                        total-items="totalItems"
                                        page="currentPage"
                                        on-select-page="pageChanged()"
                                        max-size="maxSize"
                                        boundary-links="true">
                                </pagination>
                            </div>
                            <div class="col-lg-3 pull-right">
                                <select ng-model="items_per_page"
                                        class="form-control pull-right items-per-page-dropdown">
                                    <option
                                            ng-repeat="page in items_per_page_options"
                                            value="{{ page }}">{{ page }}
                                    </option>
                                </select>
                            </div>
                            <div class="clearfix"></div>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>

<script type="text/javascript" src="js/dashboard/config.js" ></script>
<script type="text/javascript" src="js/dashboard/apicall.js" ></script>
<script type="text/javascript" src="js/dashboard/map.js" ></script>
<script type="text/javascript" src="js/dashboard/graph.js"></script>
<script type="text/javascript" src="js/dashboard/piechart.js" ></script>
<script type="text/javascript" src="js/dashboard/index.js" defer></script>
