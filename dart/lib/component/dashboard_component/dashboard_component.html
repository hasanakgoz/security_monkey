<div style="display:flow-root;">
    <div>

    </div>
    <!-- Accounts Filter Dropdown -->
</div>
<!-- Charts Component -->
<div>
    <style type="text/css">
        div.wrapper {
            text-align: center;
            width: 100%;
            display: block;
            margin-bottom: 25px;
        }

        .charthead {
            margin-top: 5px;
            color: black;
            font-style: normal;
        }

        leaflet-map {
            width: 100%;
            horiz-align: center;
            height: 300px;
            border: 1px solid #aaa;
            background-color: rgb(171, 211, 222);
        }

        .leaflet-container.leaflet-map {
            background: rgb(171, 211, 222) !important;
        }

        canvas {
            display: inline !important;
        }

        .chart-container {
            position: relative;
            margin: auto;
            height: 300px;
            /*min-height: 300px;*/
            width: 90%;
        }

        .spinner {
            position: absolute;
            left: 50%;
            top: 50%;
            height: 60px;
            width: 60px;
            margin: 0px auto;
            -webkit-animation: rotation .6s infinite linear;
            -moz-animation: rotation .6s infinite linear;
            -o-animation: rotation .6s infinite linear;
            animation: rotation .6s infinite linear;
            border-left: 6px solid rgba(0, 174, 239, .15);
            border-right: 6px solid rgba(0, 174, 239, .15);
            border-bottom: 6px solid rgba(0, 174, 239, .15);
            border-top: 6px solid rgba(0, 174, 239, .8);
            border-radius: 100%;
        }

        .nodata {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 100%;
            display: flex;
            align-items: center;
            z-index:9999;
            /*margin: 0px auto;*/
        }

        .nodata .inner {
            width: 50%;
            height: auto;
            margin: 0 auto;
            position: relative;
        }

        @-webkit-keyframes rotation {
            from {
                -webkit-transform: rotate(0deg);
            }
            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @-moz-keyframes rotation {
            from {
                -moz-transform: rotate(0deg);
            }
            to {
                -moz-transform: rotate(359deg);
            }
        }

        @-o-keyframes rotation {
            from {
                -o-transform: rotate(0deg);
            }
            to {
                -o-transform: rotate(359deg);
            }
        }

        @keyframes rotation {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(359deg);
            }
        }

    </style>

    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12 text-right pull-right" ng-switch="isAccountSelectDisabled()">
                <p>
                Accounts:
                <span ng-switch-when="true">
                    <i  class="fa fa-spinner fa-spin" style="color:darkblue"></i>
                    Loading...
                </span>
                <select ng-switch-when="false"
                        ng-disabled="isAccountSelectDisabled()" id="AccountChooser" ng-model="selectedAccount"
                        ng-change="newAccountSelected()">
                    <option value="__all_accounts__">All Accounts</option>
                    <option ng-repeat="account in accounts" value="{{ account.name }}">{{ account.name }}</option>
                </select>
                </p>
            </div>

        </div>
        <div class="row">
            <div class="col-lg-6">
                <div class="wrapper">
                    <div><h3 class="charthead">Vulnerabilities by Severity</h3></div>
                    <div class="chart-container">
                        <canvas id="severitycanvas"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="wrapper">
                    <div><h3 class="charthead">Vulnerabilities by Technology</h3></div>
                    <div class="chart-container">
                        <canvas id="categorycanvas"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <!--<div class="clearfix"></div>-->
        <div class="row">
            <div class="col-lg-6">
                <div class="wrapper">
                    <!--World Map Component-->
                    <div><h3 class="charthead">Threat Actor Locations</h3></div>
                    <leaflet-map id="worldmap" min-zoom=".75" maxBounds="[[90,-180],[-90, 180]]" fit-to-markers>
                    </leaflet-map>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="wrapper">
                    <div><h3 class="charthead">Threat Actor Connection Volume by Country</h3></div>
                    <div class="chart-container">
                        <canvas id="countrycanvas"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div>
    <!-- Accounts Summary Component -->
    <div class="col-lg-3">
        <div class="panel panel-info">
            <div class="panel-heading">
                <button type="button" class="btn btn-default btn-xs pull-right"
                        ng-click="recalculateAllSummaries()">
          <span
                  class="glyphicon glyphicon-retweet pull-right disabled">
          </span>Recalculate Scores&nbsp;
                </button>
                <h3 class="panel-title">Accounts</h3>
            </div>
            <div class="panel-body">
                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th>
                            <a ng-if="!selectAll" ng-click="selectAllToggle()" class="pointer">Select All</a>
                            <a ng-if="selectAll" ng-click="selectAllToggle()" class="pointer">Clear All</a>
                        </th>
                        <th ng-click="sortColumn('account', 'name')">
                            Account
                            <span ng-class="classForColumn('account', 'name')"></span>
                        </th>
                        <th ng-click="sortColumn('account', 'total_score')">
                            Score
                            <span ng-class="classForColumn('account', 'total_score')"></span>
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="account in accounts | orderBy:sort_params.account.sort_value">
                        <td>
                            <div class="text-center">
                                <input type="checkbox" ng-model="account.selected_for_action"/>
                            </div>
                        </td>
                        <td><a href="#/items/-/-/{{ account.name }}/-/-/-/-/-/-/-/1/25">{{account.name}}</a></td>
                        <td>{{account.total_score}}</td>
                    </tr>
                    </tbody>
                </table>
                <div ng-hide="accountsLoaded">
                    <p>Loading . . .</p>
                </div>
            </div>
        </div>
    </div>
    <!-- Technology Summary Component -->
    <div class="col-lg-3">
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">Technology Issue Scores</h3>
            </div>
            <div class="panel-body" ng-switch="technologySummaryLoaded">
                <div ng-switch-when="false">
                    <p>Loading . . .</p>
                </div>
                <table class="table table-striped" ng-switch-when="true">
                    <thead>
                    <tr>
                        <th ng-click="sortColumn('technology', 'name')">
                            Technology
                            <span ng-class="classForColumn('technology', 'name')"></span>
                        </th>
                        <th ng-click="sortColumn('technology', 'score')">
                            Score
                            <span ng-class="classForColumn('technology', 'score')"></span>
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="tech in technologies | orderBy:sort_params.technology.sort_value">
                        <td><a href="#/issues/-/{{tech.name}}/{{getAccountFilter()}}/-/-/-/True/-/-/-/1/25">{{tech.name}}</a>
                        </td>
                        <td>{{tech.score}}</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <!-- High Score Component -->
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">High Score Items</h3>
            </div>
            <div class="panel-body" ng-switch="highScoreSummaryLoaded">
                <div ng-switch-when="false">
                    <p>Loading . . .</p>
                </div>
                <table class="table table-striped" ng-switch-when="true">
                    <thead>
                    <tr>
                        <th>Account</th>
                        <th>Technology</th>
                        <th>Name</th>
                        <th>Score</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="highScoreItem in selectedItems | orderBy:'-totalScore()' | limitTo:10">
                        <td>{{highScoreItem.account}}</td>
                        <td>{{highScoreItem.technology}}</td>
                        <td><a href="#/viewitem/{{highScoreItem.id}}">{{highScoreItem.name}}</a></td>
                        <td>{{highScoreItem.totalScore()}}</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- Aging Issue Component -->
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">Aging Issues</h3>
            </div>
            <div class="panel-body" ng-switch="agingIssueSummaryLoaded">
                <div ng-switch-when="false">
                    <p>Loading . . .</p>
                </div>
                <table class="table table-striped" ng-switch-when="true">
                    <thead>
                    <tr>
                        <th>Account</th>
                        <th>Technology</th>
                        <th>Item Name</th>
                        <th>Issue</th>
                        <th>Score</th>
                        <th>Issue Date</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr ng-repeat="agingIssue in agingIssues">
                        <td>{{agingIssue.item.account}}</td>
                        <td>{{agingIssue.item.technology}}</td>
                        <td><a href="#/viewitem/{{agingIssue.item_id}}">{{agingIssue.item.name}}</a></td>
                        <td>{{agingIssue.issue}}</td>
                        <td>{{agingIssue.score}}</td>
                        <td>{{agingIssue.justified_date | date:'short'}}</td>
                        <td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>